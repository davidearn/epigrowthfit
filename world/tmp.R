load("world.RData")
world_split <- split(world, world$country_iso3)

do_plot_ <- function(formula, data, spar = NULL, endpoints = NULL, ...) {
  op <- par(mar = c(2, 3, 1, 1), mgp = c(2, 0.7, 0), las = 1)
  on.exit(par(op))
  xat <- seq(as.Date("2020-01-01"), Sys.Date(), by = "1 month")
  plot(formula, data = data, xlab = "", xaxt = "n", ...)
  abline(v = xat, lty = 3, col = "grey80")
  axis(side = 1, at = xat, labels = months(xat, TRUE), gap.axis = 0)
  if (!is.null(spar)) {
    lhs <- eval(formula[[2L]], envir = data, enclos = parent.frame())
    rhs <- eval(formula[[3L]], envir = data, enclos = parent.frame())
    dd <- data.frame(x = rhs - rhs[1], y = lhs, w = 1 / c(NA, diff(rhs)))
    dd <- dd[complete.cases(dd), , drop = FALSE]
    ss <- smooth.spline(x = dd$x, y = dd$y, w = dd$w, spar = spar)
    lines(y ~ I(rhs[1] + x), data = ss[c("x", "y")], lwd = 2, col = "red")
  }
  if (!is.null(endpoints)) {
    abline(v = as.Date(unlist(endpoints)), lty = 3)
  }
  invisible(NULL)
}
do_plot <- function(country_iso3, spar = NULL, endpoints = NULL, ...) {
  formula <- log1p(cases / dt) ~ date
  data <- world_split[[country_iso3]]
  data$dt <- c(1, diff(data$date))
  dt1 <- data$dt == 1
  do_plot_(formula,
    data = data,
    spar = spar,
    endpoints = endpoints,
    pch = 21,
    bg = c("blue", "grey80")[1L + dt1],
    ...
  )
  if (!all(dt1)) {
    text(formula, data = data, subset = !dt1, labels = data$dt,
         pos = 3, offset = 0.3, col = "grey60", cex = 0.7)
  }
  invisible(NULL)
}

ll <- list(
  AFG = list( # Afghanistan
    c("2020-03-18", "2020-04-05"),
    c("2020-05-01", "2020-06-01"),
    c("2020-09-28", "2020-10-12"),
    c("2020-11-02", "2020-11-20")
  ),
  AGO = list( # Angola
    c("2020-06-12", "2020-07-25"),
    c("2020-10-01", "2020-10-26")
  ),
  ALB = list( # Albania
    c("2020-03-16", "2020-03-29"),
    c("2020-05-18", "2020-06-19"),
    c("2020-06-28", "2020-08-15"),
    c("2020-10-11", "2020-10-22"),
    c("2020-10-30", "2020-11-10"),
    c("2020-11-11", "2020-11-21"),
    c("2021-01-16", "2021-01-29"),
    c("2021-01-30", "2021-02-09")
  ),
  AND = list( # Andorra
    c("2020-03-11", "2020-03-28"),
    c("2020-08-10", "2020-10-15"),
    c("2020-12-18", "2021-01-15"),
    c("2021-03-05", "2021-03-31")
  ),
  ARE = list( # United Arab Emirates
    c("2020-03-14", "2020-04-10"),
    c("2020-05-03", "2020-05-22"),
    c("2020-08-08", "2020-09-14"),
    c("2020-09-15", "2020-10-25"),
    c("2020-12-25", "2021-01-15")
  ),
  AUS = list( # Australia
    c("2020-03-04", "2020-03-28"),
    c("2020-06-12", "2020-07-20")
  ),
  AUT = list( # Austria
    c("2020-02-25", "2020-03-27"),
    c("2020-06-20", "2020-07-05"),
    c("2020-08-07", "2020-08-19"),
    c("2020-08-31", "2020-09-20"),
    c("2020-10-15", "2020-11-08"),
    c("2021-02-08", "2021-03-20")
  ),
  AZE = list( # Azerbaijan
    c("2020-03-18", "2020-04-09"),
    c("2020-04-29", "2020-05-18"),
    c("2020-05-22", "2020-06-08"),
    c("2020-06-15", "2020-06-26"),
    c("2020-08-09", "2020-08-24"),
    c("2020-10-02", "2020-10-25"),
    c("2020-11-09", "2020-11-29"),
    c("2021-02-25", "2021-04-01")
  ),
  BDI = list( # Burundi
    c("2020-04-20", "2020-08-01"),
    c("2020-11-20", "2021-02-01")
  ),
  BEL = list( # Belgium
    c("2020-03-01", "2020-04-01"),
    c("2020-07-01", "2020-08-08"),
    c("2020-09-01", "2020-09-25"),
    c("2020-09-28", "2020-10-25"),
    c("2021-03-05", "2021-03-27")
  ),
  BEN = list( # Benin
    c("2020-03-10", "2020-07-01"),
    c("2020-12-15", "2021-02-15")
  ),
  BFA = list( # Burkina Faso
    c("2020-03-01", "2020-03-28"),
    c("2020-07-15", "2020-10-01"),
    c("2020-11-20", "2020-12-20")
  ),
  BGD = list( # Bangladesh
    c("2020-04-01", "2020-04-18"),
    c("2020-04-25", "2020-06-20"),
    c("2020-11-06", "2020-11-20"),
    c("2021-03-06", "2021-04-05")
  ),
  BGR = list( # Bulgaria
    c("2020-03-01", "2020-03-25"),
    c("2020-04-10", "2020-04-27"),
    c("2020-05-28", "2020-06-12"),
    c("2020-06-15", "2020-07-17"),
    c("2020-10-01", "2020-11-07"),
    c("2021-01-20", "2021-03-24")
  ),
  BHR = list( # Bahrain
    c("2020-03-01", "2020-05-15"),
    c("2020-05-16", "2020-06-14"),
    c("2020-08-27", "2020-09-10"),
    c("2020-12-15", "2021-01-09"),
    c("2021-01-20", "2021-02-13"),
    c("2021-03-07", "2021-04-05")
  ),
  BHS = list( # Bahamas
    c("2020-06-25", "2020-09-01")
  ),
  BIH = list( # Bosnia and Herzegovina
    c("2020-03-01", "2020-04-02"),
    c("2020-05-31", "2020-07-12"),
    c("2020-10-08", "2020-11-01"),
    c("2021-02-11", "2021-03-25")
  ),
  BLR = list( # Belarus
    c("2020-03-21", "2020-04-18"),
    c("2020-08-16", "2020-08-28"),
    c("2020-09-25", "2020-11-02"),
    c("2020-11-07", "2020-11-17"),
    c("2020-11-19", "2020-12-13")
  ),
  BLZ = list( # Belize
    c("2020-07-23", "2020-08-21"),
    c("2020-11-19", "2020-12-07")
  ),
  BOL = list( # Bolivia
    c("2020-04-01", "2020-06-05"),
    c("2020-06-15", "2020-07-18"),
    c("2020-11-29", "2021-01-16")
  ),
  BRA = list( # Brazil
    c("2020-03-04", "2020-03-28"),
    c("2020-03-30", "2020-05-05"),
    c("2020-11-03", "2020-12-03"),
    c("2021-02-15", "2021-03-19")
  ),
  BRB = list( # Barbados
    c("2020-12-01", "2021-02-25")
  ),
  BWA = list( # Botswana
    c("2020-05-20", "2020-08-05"),
    c("2020-11-05", "2021-04-05")
  ),
  CAF = list( # Central African Republic
    c("2020-04-01", "2020-07-01")
  ),
  CAN = list( # Canada
    c("2020-03-05", "2020-04-01"),
    c("2020-09-02", "2020-10-06"),
    c("2020-10-07", "2020-12-06")
  ),
  CHE = list( # Switzerland
    c("2020-03-01", "2020-03-24"),
    c("2020-06-18", "2020-07-04"),
    c("2020-07-17", "2020-09-17"),
    c("2020-09-30", "2020-11-02"),
    c("2021-03-05", "2021-04-02")
  ),
  CHL = list( # Chile
    c("2020-03-04", "2020-04-01"),
    c("2020-04-22", "2020-06-01"),
    c("2020-12-16", "2021-01-17"),
    c("2021-02-22", "2021-04-03")
  ),
  CHN = list( # China
    c("2020-01-15", "2020-02-05"),
    c("2020-03-11", "2020-03-24"),
    c("2020-07-03", "2020-07-30"),
    c("2020-11-16", "2020-11-29"),
    c("2021-01-04", "2021-01-20")
  ),
  CIV = list( # Côte d’Ivoire
    c("2020-03-20", "2020-04-13"),
    c("2020-05-21", "2020-06-20"),
    c("2020-12-22", "2021-01-17"),
    c("2021-02-22", "2021-03-14")
  ),
  CMR = list( # Cameroon
    c("2020-03-01", "2020-04-18"),
    c("2020-04-20", "2020-07-01"),
    c("2020-12-23", "2021-04-05")
  ),
  COD = list( # Congo - Kinshasa
    c("2020-03-01", "2020-04-04"),
    c("2020-04-20", "2020-05-30"),
    c("2020-11-08", "2020-12-08")
  ),
  COG = list( # Congo - Brazzaville
    c("2020-03-01", "2020-05-18"),
    c("2020-05-20", "2020-07-28"),
    c("2020-10-01", "2020-12-20")
  ),
  COL = list( # Colombia
    c("2020-03-01", "2020-04-04"),
    c("2020-05-10", "2020-08-06"),
    c("2020-09-27", "2020-10-11"),
    c("2020-10-13", "2020-11-02"),
    c("2020-11-14", "2020-11-29"),
    c("2020-12-09", "2020-12-25"),
    c("2021-03-13", "2021-04-06")
  ),
  COM = list( # Comoros
    c("2020-12-01", "2021-02-01")
  ),
  CPV = list( # Cape Verde
    c("2020-04-08", "2020-05-08"),
    c("2020-05-24", "2020-06-14"),
    c("2020-08-20", "2020-10-10"),
    c("2020-12-23", "2021-01-17"),
    c("2021-03-10", "2021-04-01")
  ),
  CRI = list( # Costa Rica
    c("2020-03-01", "2020-03-29"),
    c("2020-05-20", "2020-07-20"),
    c("2020-08-02", "2020-09-14")
  ),
  CUB = list( # Cuba
    c("2020-03-10", "2020-04-10"),
    c("2020-07-17", "2020-08-11"),
    c("2020-10-11", "2020-10-27"),
    c("2020-11-16", "2020-12-08"),
    c("2020-12-11", "2020-12-29"),
    c("2020-12-30", "2021-01-15"),
    c("2021-01-17", "2021-02-03"),
    c("2021-03-21", "2021-04-05")
  ),
  CYP = list( # Cyprus
    c("2020-03-01", "2020-04-03"),
    c("2020-07-18", "2020-08-05"),
    c("2020-09-05", "2020-09-24"),
    c("2020-10-06", "2020-10-24"),
    c("2020-11-09", "2020-12-12"),
    c("2021-02-19", "2021-03-05")
  ),
  CZE = list( # Czechia
    c("2020-03-01", "2020-03-29"),
    c("2020-08-28", "2020-09-19"),
    c("2020-09-28", "2020-10-24"),
    c("2020-11-29", "2020-12-20"),
    c("2021-02-06", "2021-03-02")
  ),
  DEU = list( # Germany
    c("2020-02-22", "2020-03-26"),
    c("2020-07-10", "2020-08-21"),
    c("2020-10-01", "2020-10-31")
  ),
  DJI = list( # Djibouti
    c("2020-03-01", "2020-04-21"),
    c("2020-04-28", "2020-06-10"),
    c("2021-02-23", "2021-04-06")
  ),
  DNK = list( # Denmark
    c("2020-02-25", "2020-03-18"),
    c("2020-03-19", "2020-04-08"),
    c("2020-07-06", "2020-08-11"),
    c("2020-08-28", "2020-09-22"),
    c("2020-10-18", "2020-11-01"),
    c("2020-11-28", "2020-12-19"),
    c("2021-02-14", "2021-03-20")
  ),
  DOM = list( # Dominican Republic
    c("2020-03-12", "2020-04-01"),
    c("2020-06-02", "2020-07-27"),
    c("2020-11-15", "2020-12-31")
  ),
  DZA = list( # Algeria
    c("2020-03-08", "2020-04-04"),
    c("2020-04-18", "2020-05-09"),
    c("2020-06-23", "2020-07-08"),
    c("2020-10-09", "2020-10-27"),
    c("2020-10-30", "2020-11-10")
  ),
  ECU = list( # Ecuador
    c("2020-03-09", "2020-03-27"),
    c("2020-05-27", "2020-07-18"),
    c("2020-12-25", "2021-01-21")
  ),
  EGY = list( # Egypt
    c("2020-02-29", "2020-03-26"),
    c("2020-03-28", "2020-04-09"),
    c("2020-04-19", "2020-05-10"),
    c("2020-05-11", "2020-06-01"),
    c("2020-08-19", "2020-08-31"),
    c("2020-10-26", "2020-11-10"),
    c("2020-11-13", "2020-11-23"),
    c("2020-12-18", "2021-01-01")
  ),
  ERI = list( # Eritrea
    c("2020-05-08", "2020-07-03"),
    c("2020-11-06", "2021-01-15")
  ),
  ESP = list( # Spain
    c("2020-02-22", "2020-03-23"),
    c("2020-07-03", "2020-08-07"),
    c("2020-10-09", "2020-11-04"),
    c("2020-12-28", "2021-01-22")
  ),
  EST = list( # Estonia
    c("2020-03-01", "2020-03-28"),
    c("2020-08-14", "2020-10-02"),
    c("2020-10-17", "2020-11-14"),
    c("2020-11-17", "2020-12-20"),
    c("2021-02-10", "2021-03-10")
  ),
  ETH = list( # Ethiopia
    c("2020-04-25", "2020-06-05"),
    c("2020-07-11", "2020-07-28"),
    c("2020-08-05", "2020-08-23"),
    c("2020-09-23", "2020-10-04"),
    c("2021-01-19", "2021-02-05"),
    c("2021-03-03", "2021-03-30")
  ),
  FIN = list( # Finland
    c("2020-02-25", "2020-03-25"),
    c("2020-07-25", "2020-08-12"),
    c("2020-09-02", "2020-10-12"),
    c("2020-11-09", "2020-11-28"),
    c("2021-01-09", "2021-01-31"),
    c("2021-02-10", "2021-02-28")
  ),
  FRA = list( # France
    c("2020-02-26", "2020-03-14"),
    c("2020-07-01", "2020-09-27"),
    c("2020-10-05", "2020-11-06"),
    c("2020-11-30", "2020-12-30")
  ),
  GAB = list( # Gabon
    c("2020-03-01", "2020-06-05"),
    c("2020-09-18", "2020-12-18"),
    c("2020-12-25", "2021-02-26")
  ),
  GBR = list( # United Kingdom
    c("2020-02-23", "2020-03-20"),
    c("2020-07-25", "2020-08-13"),
    c("2020-08-30", "2020-09-12"),
    c("2020-09-13", "2020-09-26"),
    c("2020-09-27", "2020-10-09"),
    c("2020-10-10", "2020-10-24"),
    c("2020-12-06", "2021-01-07")
  ),
  GEO = list( # Georgia
    c("2020-02-25", "2020-04-13"),
    c("2020-08-27", "2020-09-17"),
    c("2020-09-20", "2020-10-06"),
    c("2020-10-11", "2020-10-26"),
    c("2020-11-06", "2020-12-06")
  ),
  GHA = list( # Ghana
    c("2020-03-18", "2020-05-09"),
    c("2020-06-02", "2020-07-09"),
    c("2020-10-04", "2020-11-10"),
    c("2021-01-02", "2021-01-30")
  ),
  GIN = list( # Guinea
    c("2020-03-20", "2020-04-15"),
    c("2020-06-20", "2020-07-12"),
    c("2020-09-27", "2020-10-18"),
    c("2021-02-01", "2021-03-17")
  ),
  GMB = list( # Gambia
    c("2020-06-15", "2020-09-01"),
    c("2020-12-14", "2021-03-01")
  ),
  GRC = list( # Greece
    c("2020-02-25", "2020-03-27"),
    c("2020-07-21", "2020-08-16"),
    c("2020-09-03", "2020-10-01"),
    c("2020-10-10", "2020-11-14"),
    c("2021-01-19", "2021-02-11"),
    c("2021-03-01", "2021-04-05")
  ),
  GTM = list( # Guatemala
    c("2020-04-01", "2020-05-26"),
    c("2020-05-31", "2020-07-07"),
    c("2020-12-18", "2021-01-21")
  ),
  GUY = list( # Guyana
    c("2020-07-20", "2020-08-24"),
    c("2020-12-29", "2021-01-24"),
    c("2021-02-24", "2021-03-21")
  ),
  HND = list( # Honduras
    c("2020-03-10", "2020-05-27"),
    c("2020-05-30", "2020-06-30"),
    c("2021-01-01", "2021-01-23")
  ),
  HRV = list( # Croatia
    c("2020-03-05", "2020-03-28"),
    c("2020-06-10", "2020-07-03"),
    c("2020-08-01", "2020-08-28"),
    c("2020-10-08", "2020-10-30"),
    c("2020-11-13", "2020-12-05"),
    c("2021-02-15", "2021-03-13")
  ),
  HTI = list( # Haiti
    c("2020-05-01", "2020-05-24"),
    c("2020-11-28", "2020-12-24"),
    c("2020-12-28", "2021-01-24")
  ),
  HUN = list( # Hungary
    c("2020-03-01", "2020-03-28"),
    c("2020-07-03", "2020-08-17"),
    c("2020-08-21", "2020-09-15"),
    c("2020-10-15", "2020-11-11"),
    c("2021-02-10", "2021-03-15")
  ),
  IDN = list( # Indonesia
    c("2020-03-01", "2020-03-28"),
    c("2020-05-05", "2020-07-05"),
    c("2020-08-22", "2020-09-06"),
    c("2020-11-03", "2020-11-29"),
    c("2020-12-03", "2020-12-25"),
    c("2021-01-01", "2021-01-23")
  ),
  IND = list( # India
    c("2020-03-04", "2020-04-15"),
    c("2020-05-25", "2020-08-01"),
    c("2020-08-22", "2020-09-12"),
    c("2021-03-07", "2021-03-28")
  ),
  IRL = list( # Ireland
    c("2020-03-01", "2020-03-28"),
    c("2020-07-22", "2020-08-10"),
    c("2020-08-13", "2020-10-01"),
    c("2020-10-03", "2020-10-20"),
    c("2020-12-10", "2020-12-25"),
    c("2020-12-26", "2021-01-08")
  ),
  IRN = list( # Iran
    c("2020-02-20", "2020-03-07"),
    c("2020-03-20", "2020-03-30"),
    c("2020-05-04", "2020-05-21"),
    c("2020-05-24", "2020-06-05"),
    c("2020-09-09", "2020-09-24"),
    c("2020-09-25", "2020-10-15"),
    c("2020-10-16", "2020-11-03"),
    c("2020-11-04", "2020-11-19"),
    c("2021-01-28", "2021-02-23"),
    c("2021-03-24", "2021-04-05")
  ),
  IRQ = list( # Iraq
    c("2020-03-10", "2020-03-31"),
    c("2020-04-13", "2020-05-01"),
    c("2020-05-21", "2020-06-08"),
    c("2020-06-11", "2020-06-26"),
    c("2020-07-15", "2020-07-31"),
    c("2020-08-01", "2020-08-19"),
    c("2021-01-31", "2021-02-20"),
    c("2021-02-21", "2021-04-05")
  ),
  ISL = list( # Iceland
    c("2020-02-25", "2020-04-10"),
    c("2020-07-09", "2020-08-27"),
    c("2020-09-03", "2020-10-29"),
    c("2021-02-18", "2021-04-01")
  ),
  ISR = list( # Israel
    c("2020-02-25", "2020-04-01"),
    c("2020-05-22", "2020-06-04"),
    c("2020-06-18", "2020-07-10"),
    c("2020-08-29", "2020-09-18"),
    c("2020-12-10", "2021-01-14")
  ),
  ITA = list( # Italy
    c("2020-02-26", "2020-03-21"),
    c("2020-08-15", "2020-08-30"),
    c("2020-10-03", "2020-11-01"),
    c("2021-02-13", "2021-03-10")
  ),
  JAM = list( # Jamaica
    c("2020-03-01", "2020-04-25"),
    c("2020-08-12", "2020-09-02"),
    c("2020-09-03", "2020-09-21"),
    c("2021-01-26", "2021-02-13"),
    c("2021-02-28", "2021-03-11")
  ),
  JOR = list( # Jordan
    c("2020-03-10", "2020-03-27"),
    c("2020-04-27", "2020-05-12"),
    c("2020-05-23", "2020-06-12"),
    c("2020-08-01", "2020-09-01"),
    c("2020-09-04", "2020-10-06"),
    c("2020-10-15", "2020-11-06"),
    c("2021-02-05", "2021-03-18")
  ),
  JPN = list( # Japan
    c("2020-02-12", "2020-03-12"),
    c("2020-03-20", "2020-04-12"),
    c("2020-05-16", "2020-06-18"),
    c("2020-06-30", "2020-08-02"),
    c("2020-10-31", "2020-11-22"),
    c("2020-11-28", "2020-12-30"),
    c("2020-12-31", "2021-01-10"),
    c("2021-03-16", "2021-04-04")
  ),
  KAZ = list( # Kazakhstan
    c("2020-03-10", "2020-04-16"),
    c("2020-06-03", "2020-07-13"),
    c("2020-10-16", "2020-11-15"),
    c("2021-01-09", "2021-01-24"),
    c("2021-03-10", "2021-04-04")
  ),
  KEN = list( # Kenya
    c("2020-03-10", "2020-04-08"),
    c("2020-04-30", "2020-06-07"),
    c("2020-06-18", "2020-08-01"),
    c("2020-09-29", "2020-10-31"),
    c("2021-02-19", "2021-03-25")
  ),
  KGZ = list( # Kyrgyzstan
    c("2020-03-19", "2020-04-13"),
    c("2020-06-07", "2020-06-29"),
    c("2020-09-12", "2020-10-25")
  ),
  KHM = list( # Cambodia
    c("2021-01-24", "2021-04-04")
  ),
  KOR = list( # South Korea
    c("2020-02-10", "2020-03-01"),
    c("2020-05-15", "2020-06-06"),
    c("2020-08-05", "2020-08-23"),
    c("2020-11-05", "2020-11-20"),
    c("2020-11-22", "2020-12-19")
  ),
  KWT = list( # Kuwait
    c("2020-03-01", "2020-04-05"),
    c("2020-04-10", "2020-05-18"),
    c("2020-06-12", "2020-07-03"),
    c("2020-09-30", "2020-10-23"),
    c("2020-12-25", "2021-01-15"),
    c("2021-01-23", "2021-02-12"),
    c("2021-02-20", "2021-03-11")
  ),
  LBN = list( # Lebanon
    c("2020-02-15", "2020-03-26"),
    c("2020-06-30", "2020-07-19"),
    c("2020-07-21", "2020-08-28"),
    c("2020-09-07", "2020-10-01"),
    c("2020-12-18", "2021-01-14")
  ),
  LBR = list( # Liberia
    c("2020-03-05", "2020-05-03"),
    c("2020-05-10", "2020-06-28"),
    c("2020-09-20", "2020-12-06")
  ),
  LBY = list( # Libya
    c("2020-05-12", "2020-06-09"),
    c("2020-06-19", "2020-08-18"),
    c("2020-08-21", "2020-09-11"),
    c("2020-12-30", "2021-01-22"),
    c("2021-02-12", "2021-03-12")
  ),
  LIE = list( # Liechtenstein
    c("2020-09-15", "2020-11-17")
  ),
  LKA = list( # Sri Lanka
    c("2020-03-10", "2020-05-04"),
    c("2020-09-15", "2020-11-03"),
    c("2020-11-15", "2020-12-12"),
    c("2021-01-02", "2021-01-28")
  ),
  LSO = list( # Lesotho
    c("2020-06-02", "2020-08-04"),
    c("2020-11-17", "2021-01-26")
  ),
  LTU = list( # Lithuania
    c("2020-03-10", "2020-03-28"),
    c("2020-06-27", "2020-08-20"),
    c("2020-09-07", "2020-09-30"),
    c("2020-10-11", "2020-11-09"),
    c("2020-11-10", "2020-12-20")
  ),
  LUX = list( # Luxembourg
    c("2020-03-08", "2020-03-22"),
    c("2020-06-18", "2020-07-12"),
    c("2020-10-12", "2020-10-30")
  ),
  LVA = list( # Latvia
    c("2020-03-01", "2020-03-27"),
    c("2020-09-13", "2020-10-10"),
    c("2020-10-27", "2020-12-05")
  ),
  MAR = list( # Morocco
    c("2020-03-05", "2020-03-31"),
    c("2020-04-01", "2020-04-21"),
    c("2020-06-10", "2020-06-27"),
    c("2020-07-16", "2020-08-09"),
    c("2020-08-23", "2020-09-19"),
    c("2020-09-29", "2020-11-13")
  ),
  MCO = list( # Monaco
    c("2020-09-25", "2020-11-13"),
    c("2020-11-20", "2021-02-05")
  ),
  MDA = list( # Moldova
    c("2020-03-12", "2020-04-10"),
    c("2020-05-27", "2020-06-20"),
    c("2020-07-13", "2020-08-27"),
    c("2020-09-07", "2020-10-10"),
    c("2020-11-02", "2020-11-26"),
    c("2021-01-25", "2021-03-03")
  ),
  MDG = list( # Madagascar
    c("2020-04-19", "2020-05-30"),
    c("2020-06-13", "2020-07-18")
  ),
  MEX = list( # Mexico
    c("2020-03-08", "2020-03-22"),
    c("2020-03-29", "2020-04-10"),
    c("2020-04-12", "2020-04-25"),
    c("2020-04-29", "2020-05-26"),
    c("2020-05-27", "2020-06-25"),
    c("2020-11-17", "2020-11-28"),
    c("2021-01-04", "2021-01-22")
  ),
  MLI = list( # Mali
    c("2020-03-20", "2020-04-26"),
    c("2020-10-28", "2020-11-25"),
    c("2021-02-25", "2021-03-12")
  ),
  MLT = list( # Malta
    c("2020-03-05", "2020-03-25"),
    c("2020-07-15", "2020-08-17"),
    c("2020-09-26", "2020-10-20"),
    c("2020-12-22", "2021-01-10"),
    c("2021-02-15", "2021-03-06")
  ),
  MMR = list( # Myanmar (Burma)
    c("2020-04-02", "2020-04-16"),
    c("2020-08-14", "2020-08-30"),
    c("2020-08-31", "2020-09-28"),
    c("2020-11-06", "2020-11-26")
  ),
  MNG = list( # Mongolia
    c("2020-10-24", "2020-11-23"),
    c("2021-01-19", "2021-02-11"),
    c("2021-02-24", "2021-04-05")
  ),
  MOZ = list( # Mozambique
    c("2020-04-28", "2020-06-15"),
    c("2020-07-19", "2020-08-15"),
    c("2020-09-01", "2020-09-22"),
    c("2020-12-25", "2021-01-21")
  ),
  MRT = list( # Mauritania
    c("2020-05-08", "2020-05-23"),
    c("2020-05-27", "2020-06-21"),
    c("2020-11-17", "2020-12-11")
  ),
  MUS = list( # Mauritius
    c("2021-02-09", "2021-04-06")
  ),
  MWI = list( # Malawi
    c("2020-06-07", "2020-07-06"),
    c("2020-12-25", "2021-01-16")
  ),
  MYS = list( # Malaysia
    c("2020-02-25", "2020-03-22"),
    c("2020-08-30", "2020-09-12"),
    c("2020-09-18", "2020-10-14"),
    c("2020-10-18", "2020-12-13"),
    c("2020-12-22", "2021-01-22")
  ),
  NAM = list( # Namibia
    c("2020-06-10", "2020-07-07"),
    c("2020-07-28", "2020-08-25"),
    c("2020-11-22", "2020-12-22")
  ),
  NER = list( # Niger
    c("2020-10-22", "2020-12-31")
  ),
  NGA = list( # Nigeria
    c("2020-04-08", "2020-05-09"),
    c("2020-06-01", "2020-06-20"),
    c("2020-11-21", "2020-12-19"),
    c("2020-12-24", "2021-01-16")
  ),
  NIC = list( # Nicaragua
    c("2020-04-08", "2020-06-10")
  ),
  NLD = list( # Netherlands
    c("2020-02-25", "2020-03-09"),
    c("2020-03-10", "2020-03-29"),
    c("2020-07-05", "2020-07-22"),
    c("2020-07-24", "2020-08-10"),
    c("2020-08-30", "2020-09-24"),
    c("2020-09-30", "2020-10-18"),
    c("2020-11-29", "2020-12-21"),
    c("2021-02-09", "2021-02-28"),
    c("2021-03-06", "2021-03-28")
  ),
  NOR = list( # Norway
    c("2020-02-25", "2020-03-23"),
    c("2020-07-15", "2020-08-08"),
    c("2020-08-21", "2020-09-11"),
    c("2020-10-15", "2020-11-06"),
    c("2020-12-04", "2021-01-08"),
    c("2021-02-18", "2021-03-19")
  ),
  NPL = list( # Nepal
    c("2020-04-29", "2020-06-06"),
    c("2020-07-27", "2020-09-01"),
    c("2020-09-24", "2020-10-12")
  ),
  NZL = list( # New Zealand
    c("2020-02-20", "2020-04-09")
  ),
  OMN = list( # Oman
    c("2020-03-29", "2020-04-18"),
    c("2020-04-29", "2020-05-24"),
    c("2020-05-28", "2020-07-14"),
    c("2020-09-03", "2020-09-23"),
    c("2021-02-01", "2021-02-22"),
    c("2021-02-24", "2021-04-05")
  ),
  PAK = list( # Pakistan
    c("2020-03-06", "2020-03-20"),
    c("2020-03-22", "2020-05-11"),
    c("2020-05-24", "2020-06-06"),
    c("2020-08-31", "2020-09-23"),
    c("2020-10-18", "2020-11-27"),
    c("2021-02-28", "2021-03-27")
  ),
  PAN = list( # Panama
    c("2020-03-10", "2020-03-31"),
    c("2020-05-17", "2020-05-31"),
    c("2020-06-16", "2020-07-12"),
    c("2020-11-09", "2020-12-20")
  ),
  PER = list( # Peru
    c("2020-03-01", "2020-03-22"),
    c("2020-03-23", "2020-04-12"),
    c("2020-04-16", "2020-05-03"),
    c("2020-07-22", "2020-08-17"),
    c("2020-12-31", "2021-01-31")
  ),
  PHL = list( # Philippines
    c("2020-03-17", "2020-04-01"),
    c("2020-05-20", "2020-06-01"),
    c("2020-06-26", "2020-07-08"),
    c("2020-05-20", "2020-08-15"),
    c("2021-02-28", "2021-03-30")
  ),
  PNG = list( # Papua New Guinea
    c("2020-07-02", "2020-08-20"),
    c("2021-01-14", "2021-04-01")
  ),
  POL =

)



l <- list( # Poland
  c("2020-03-01", "2020-04-10"),
  c("2020-07-13", "2020-08-13"),
  c("2020-09-06", "2020-11-10"),
  c("2021-02-10", "2021-03-25")
)

s <- "POL"
as.character(worldstats$country_name[match(s, worldstats$country_iso3, 0L)])
spar <- 0.3
do_plot(s, spar = spar, endpoints = l,
        xlim = as.Date(c("2020-03-01", "2020-06-01")),
        ylim = c(0,7))
do_plot(s, spar = spar, endpoints = l, ylim = NULL)
do_plot(s, spar = spar, endpoints = NULL, ylim = NULL)


# [121] "PNG" "POL" "PRT" "PRY" "PSE" "QAT" "ROU" "RUS" "RWA" "SAU"
# [131] "SDN" "SEN" "SGP" "SLE" "SLV" "SMR" "SOM" "SRB" "SSD" "SUR"
# [141] "SVK" "SVN" "SWE" "SWZ" "SYC" "SYR" "TCD" "TGO" "THA" "TJK"
# [151] "TLS" "TTO" "TUN" "TUR" "TWN" "TZA" "UGA" "UKR" "URY" "USA"
# [161] "UZB" "VEN" "VNM" "YEM" "ZAF" "ZMB" "ZWE"

